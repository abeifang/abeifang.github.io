<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>伙伴匹配系统 | 阿北笔记</title><meta name="keywords" content="项目实践,Java"><meta name="author" content="Abei"><meta name="copyright" content="Abei"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="伙伴匹配系统"><meta name="application-name" content="伙伴匹配系统"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="伙伴匹配系统"><meta property="og:url" content="http://abeibiji.cn/2024/05/11/伙伴匹配系统/index.html"><meta property="og:site_name" content="阿北笔记"><meta property="og:description" content="伙伴匹配系统介绍：帮助用户找到志同道合的伙伴      需求分析 用户去添加标签，标签的分类（要哪些标签，怎么把标签进行分类）学习方向？ 主动搜索：允许用户根据标签去搜索其他用户 Redis 缓存   组队 创建队伍 加入队伍 根据标签查询队伍 邀请其他人   允许用户去修改标签 推荐 相似度计算算"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://abei-1256557411.cos.ap-chengdu.myqcloud.com/blogs/202406032223397.png"><meta property="article:author" content="Abei"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://abei-1256557411.cos.ap-chengdu.myqcloud.com/blogs/202406032223397.png"><meta name="description" content="伙伴匹配系统介绍：帮助用户找到志同道合的伙伴      需求分析 用户去添加标签，标签的分类（要哪些标签，怎么把标签进行分类）学习方向？ 主动搜索：允许用户根据标签去搜索其他用户 Redis 缓存   组队 创建队伍 加入队伍 根据标签查询队伍 邀请其他人   允许用户去修改标签 推荐 相似度计算算"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://abeibiji.cn/2024/05/11/%E4%BC%99%E4%BC%B4%E5%8C%B9%E9%85%8D%E7%B3%BB%E7%BB%9F/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?f9522a0fcf4f7f8c58d9fdbacbef17a2";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":["🤖️ 数码科技爱好者","🔍 分享与热心帮助","🏠 智能家居小能手","🔨 设计开发一条龙","🤝 专修交互与设计","🏃 脚踏实地行动派","🧱 团队小组发动机","💢 壮汉人狠话不多"]},
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: Abei","link":"链接: ","source":"来源: 阿北笔记","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '阿北笔记',
  title: '伙伴匹配系统',
  postAI: '',
  pageFillDescription: '伙伴匹配系统, 需求分析, 技术栈, 前端, 后端, 第一期, 前端项目初始化, 前端主页 + 组件概览, 设计, 开发, 数据库表设计, 标签表（分类表）, 用户表, 开发后端接口, 用户中心来集中提供用户的检索、操作、登录、鉴权等等, 第二期, Java 8, 前端整合路由, 第三期, 后端整合Swagger + Knife4j 接口文档, 第四期, 前端页面跳转传值, 整合Axios, Session 共享, Cookie 范围, 为什么需要共享？, 如何共享存储, Session 共享实现, 其他单点登陆方案, 开发主页, 100 万用户数据插入方式, 编写一次性任务, 使用缓存优化性能, 缓存, Redis, Redis 数据结构, Java里的实现方式, ※Spring Data Redis, Jedis, Redisson, Lettuce, 设计缓存 Key, 将推荐改为缓存实现, 缓存预热, 怎么缓存预热？, 定时任务实现伙伴匹配系统介绍帮助用户找到志同道合的伙伴需求分析用户去添加标签标签的分类要哪些标签怎么把标签进行分类学习方向主动搜索允许用户根据标签去搜索其他用户缓存组队创建队伍加入队伍根据标签查询队伍邀请其他人允许用户去修改标签推荐相似度计算算法本地分布式计算技术栈前端开发框架提交页面开发效率基于的移动端组件库版打包工具快来单机部署后端编程语言框架数据库缓存接口文档第一期前端初始化前端主页组件概览数据库表设计标签表用户表开发后端根据标签搜索用户开发前端根据标签搜索用户前端项目初始化用脚手架初始化项目脚手架整合组件库安装按需引入指令参考官方文档开发页面经验多参考从整体到局部先想清楚页面要做成什么样子再写代码前端主页组件概览设计导航条展示当前页面主页搜索框推荐页搜索结果页内容栏主页推荐页广告搜索框推荐信息流队伍页用户页开发很多页面要复用组件样式重复写很麻烦不利于维护所以抽象一个通用的布局数据库表设计标签的分类要有哪些标签怎么把标签分类标签表分类表建议用标签不要用分类更灵活性别男女方向目标考研春招秋招考公竞赛身份大学生待业研究生状态乐观有点丧一般单身已婚有对象用户自定义标签字段主键标签名非空必须唯一唯一索引上传标签的用户普通索引父标签分类是否为父标签创建时间更新时间是否删除怎么查询所有标签并且把标签分好组能实现根据父标签查询子标签根据查询语言分类建表操作表更新删除数据影响实际表里的内容控制权限查询用户表用户有哪些标签直接在用户表补充字段男存字符串优点查询方便不用新建关联表标签是用户的固有属性除了该系统其他系统可能也要使用节省开发成本缺点用户表多一列会有点哪怕性能低可以用缓存加一个关联表记录用户和标签的关系优点查询灵活可以正查反查缺点要多建一个表多维护一个表重点企业大项目开发中尽量减少关联查询很影响扩展性而且会影响查询性能开发后端接口搜索标签允许用户传入多个标签多个标签都存在才搜索出来允许用户传入多个标签有任何一个标签存在就能搜索出来两种方式查询内存查询用户中心来集中提供用户的检索操作登录鉴权等等第二期前端开发搜索页面用户信息页用户信息修改页前端整合路由后端整合接口文档存量用户信息导入及同步爬虫流式处理可选类前端整合路由点击去官方文档其实就是帮助你根据不同的来展示不同的页面组件不用自己写路由配置影响整个项目所以建议单独用目录单独的配置文件去集中定义和管理有些组件库可能自带了和的整合所以尽量先看组件文档省去自己写的时间第三期计划后端整合接口文档存量用户信息导入及同步爬虫前后端联调搜索页面用户信息页用户信息修改页标签整理部分细节优化后端整合接口文档什么是接口文档写接口信息的文档每条接口包括请求参数响应参数错误码接口地址接口名称请求类型请求格式备注谁用一般是后端或者负责人提供后端前端都要使用为什么需要接口文档有个书面内容背书或者归档便于大家参考和查阅便于沉淀和维护拒绝口口相传有个文档方便与前端和后端开发对接前端后端联调的介质后端接口文档前端好的接口文档支持在线调试在线测试可以作为工具提高我们的开发测试效率怎么做接口文档手写比如腾讯文档笔记自动化接口文档生成侧重接口管理国产原理自定义配置类定义需要生成接口文档的代码位置千万注意线上环境不要把接口暴露出去可直接引入其集成了和引入请见官方文档前端插件推荐安装第四期计划页面和功能开发搜索页面用户信息用户修改页面改造用户中心把单机登录改为分布式登录标签的整理细节的优化前端页面跳转传值后附加参数传递值长度有限全局状态管理搜索页将关键词塞到状态中搜索结果页从状态中取值以下代码使用参考官方文档字符串路径带有路径的对象命名路由并加上参数让路由建立带查询参数结果是带结果是整合点击去官方文档中文文档共享范围种的时候注意范围项目中可以通过来配置版本之后不需要配置比如两个域名如果要共享可以种一个更高层的公共域名比如为什么需要共享思考为什么服务器登录后请求发送到服务器不认识该用户原因用户在登录所以用户登录信息存在了上结果请求时没有用户信息所以不认识如图解决方案共享存储而不是把数据放到单台服务器的内存中如何共享存储核心思想把数据放到同一个地方去管理基于内存的数据库此处选择因为用户信息读取是否登录的判断极其频繁基于内存读写性能很高简单的数据单机文件服务器共享实现安装安装管理工具引入依赖具有时效性具体依赖参考仓库引入和的整合使得自动将存储到中其他单点登陆方案常用的就是对比的优缺点基于和的区别和优缺点开发主页直接使用的组件列表展示模拟万用户数据查询万用户数据插入方式用编译器的可视化界面导入适合一次性导入数据量可控编写程序循环建议分批不要一把梭哈可以用接口来控制要保证可控幂等注意线上环境和测试环境是有区别的执行语句适用于小数据量编写一次性任务使用循环遍历插入数据批量插入用户数据写在了测试类里面程序运行时记得注释不然会自动运行测试类检测运行时间使用数组分批插入效率较高假用户假用户男这是假用户使用层的批量插入数据使用多线程插入数据这里要在前面声明自定义线程池自定义线程池密集型分配的核心线程数密集型分配的核心线程数可以大于核数并发批量插入用户数据分二十组假用户假用户男这是假用户异步执行从自带的线程池中取从自定义的线程池中取使用缓存优化性能目前首页数据加载时间添加缓存后的加载时间数据库慢预先把数据查出来放到一个更快读取的地方不用再查数据库了缓存防止第一个用户的数据加载是从数据库中取出从而导致第一个用户或者前几个用户的体验较差预加载缓存定时更新缓存定时任务多个机器都要执行任务么分布式锁控制同一时间只有一台机器去执行定时任务其他机器不用重复执行了缓存提前把数据取出来保存好通常保存到读写更快的介质比如内存就可以更快的读写缓存的实现分布式缓存分布式云原生架构的一个分布式存储存储配置扩容能力强单机本地缓存内存内存缓存高性能定义数据库存储系统区别于他存储的是键值对数据结构字符串类型列表集合值不能重复哈希键不能重复集合每个值都要指定一个分数适合做排行榜布隆过滤器主要从大量的数据中快速过滤值比如拦截邮件黑名单计算地理位置发布订阅类似消息队列里的实现方式通用的数据访问框架定义了一组增删改查的接口引入引入版本需于的版本一致配置地址独立于操作的客户端要配合使用分布式操作的客户端让你像在使用本地集合一样操作分布式数据网格高阶的操作的客户端对比如果你用的是并且没有过多的定制化要求可以用最方便如果你用的不是并且追求简单并且没有过高的性能要求可以用如果你的项目不是并且追求高性能高定制化可以用支持异步连接池如果你的项目是分布式的需要用到一些分布式的特性比如分布式锁分布式集合推荐用设计缓存不同用户看到的数据不同不要和别人冲突内存不能无限增加一定要设置过期时间将推荐改为缓存实现直接查询数据库所有数据并返回修改后如果有缓存直接读缓存无缓存查数据库记得设置过期时间缓存预热问题第一个用户访问很慢怎么优化缓存预热的优缺点解决第一个用户访问慢的问题缺点增加开发成本额外开发设计预热的时机和时间如果错了有可能你缓存的数据不对或者太老需要占用额外空间分析优缺点的时候要打开思路从整个项目从到的链路上去分析注意点缓存预热的意义新增少总用户多缓存的空间不能太大要预留给其他缓存空间缓存数据的周期怎么缓存预热定时模拟触发手动触发定时任务实现默认整合了独立于存在的定时任务框架之类的分布式任务调度平台界面用定时任务每天刷新所有用户的推荐列表第一种方式实现主类开启给要定时执行的方法添加注解指定表达式或者执行频率',
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2024-06-04 20:03:50',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.2.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://abei-1256557411.cos.ap-chengdu.myqcloud.com/blogs/avatar.jpeg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://qm.qq.com/cgi-bin/qm/qr?k=okp4sxwdxgy0r6hgoueO-1zWTPl044RT" title="博主"><img class="back-menu-item-icon" src="/img/favicon.ico" alt="博主"/><span class="back-menu-item-text">博主</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" href="/null" title="项目暂未上线"><img class="back-menu-item-icon" src="https://image.anheyu.com/favicon.ico" alt="项目暂未上线"/><span class="back-menu-item-text">项目暂未上线</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">阿北笔记</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 文章列表</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 文章分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 全部标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 专栏</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/tags/%E6%9D%82%E8%B0%88"><i class="anzhiyufont anzhiyu-icon-heartbeat faa-tada" style="font-size: 0.9em;"></i><span> 杂谈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/%E5%87%BA%E6%B8%B8%E8%AE%B0%E5%BD%95"><i class="anzhiyufont anzhiyu-icon-thumbs-up faa-tada" style="font-size: 0.9em;"></i><span> 旅行</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill faa-tada" style="font-size: 0.9em;"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/Awebsite/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 优质站点</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/equipment/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 我的装备</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-circle-dot faa-tada" style="font-size: 0.9em;"></i><span> 关于本站</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="/pay/wechat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="/pay/wechat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/pay/zhifubao.jpg" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="/pay/zhifubao.jpg"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Java/" style="font-size: 1.05rem;">Java<sup>4</sup></a><a href="/tags/Python/" style="font-size: 1.05rem;">Python<sup>3</sup></a><a href="/tags/%E4%B8%8A%E7%BA%BF/" style="font-size: 1.05rem;">上线<sup>2</sup></a><a href="/tags/%E4%BA%91%E6%97%85%E8%A1%8C/" style="font-size: 1.05rem;">云旅行<sup>4</sup></a><a href="/tags/%E5%87%BA%E6%B8%B8%E8%AE%B0%E5%BD%95/" style="font-size: 1.05rem;">出游记录<sup>1</sup></a><a href="/tags/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/" style="font-size: 1.05rem;">图像处理<sup>1</sup></a><a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 1.05rem;">工具<sup>1</sup></a><a href="/tags/%E6%9D%82%E8%B0%88/" style="font-size: 1.05rem;">杂谈<sup>4</sup></a><a href="/tags/%E6%AF%8F%E6%97%A5%E6%89%93%E5%8D%A1/" style="font-size: 1.05rem;">每日打卡<sup>1</sup></a><a href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" style="font-size: 1.05rem;">深度学习<sup>1</sup></a><a href="/tags/%E7%AE%97%E6%B3%95%E7%A0%94%E7%A9%B6/" style="font-size: 1.05rem;">算法研究<sup>1</sup></a><a href="/tags/%E8%B8%A9%E5%9D%91/" style="font-size: 1.05rem;">踩坑<sup>2</sup></a><a href="/tags/%E9%98%85%E8%AF%BB%E5%88%86%E4%BA%AB/" style="font-size: 1.05rem;">阅读分享<sup>1</sup></a><a href="/tags/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5/" style="font-size: 1.05rem;">项目实践<sup>3</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/05/"><span class="card-archive-list-date">五月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">21</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0/" itemprop="url">学习</a><i class="anzhiyufont anzhiyu-icon-angle-right post-meta-separator"></i><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0/%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/" itemprop="url">个人项目</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>项目实践</span></a><a class="article-meta__tags" href="/tags/Java/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Java</span></a></span></div></div><h1 class="post-title" itemprop="name headline">伙伴匹配系统</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-05-11T07:31:08.000Z" title="发表于 2024-05-11 15:31:08">2024-05-11</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-06-04T12:03:50.260Z" title="更新于 2024-06-04 20:03:50">2024-06-04</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">4.1k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>14分钟</span></span><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="伙伴匹配系统"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为重庆"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>重庆</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://abei-1256557411.cos.ap-chengdu.myqcloud.com/blogs/202406032223397.png"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://abeibiji.cn/2024/05/11/%E4%BC%99%E4%BC%B4%E5%8C%B9%E9%85%8D%E7%B3%BB%E7%BB%9F/"><header><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0/" itemprop="url">学习</a><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0/%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/" itemprop="url">个人项目</a><a href="/tags/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5/" tabindex="-1" itemprop="url">项目实践</a><a href="/tags/Java/" tabindex="-1" itemprop="url">Java</a><h1 id="CrawlerTitle" itemprop="name headline">伙伴匹配系统</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">Abei</span><time itemprop="dateCreated datePublished" datetime="2024-05-11T07:31:08.000Z" title="发表于 2024-05-11 15:31:08">2024-05-11</time><time itemprop="dateCreated datePublished" datetime="2024-06-04T12:03:50.260Z" title="更新于 2024-06-04 20:03:50">2024-06-04</time></header><h1 id="伙伴匹配系统"><a href="#伙伴匹配系统" class="headerlink" title="伙伴匹配系统"></a>伙伴匹配系统</h1><div class="tip info"><p>介绍：帮助用户找到志同道合的伙伴 </p>
</div>



<h2 id="需求分析"><a href="#需求分析" class="headerlink" title="需求分析"></a>需求分析</h2><ol>
<li>用户去添加标签，标签的分类（要哪些标签，怎么把标签进行分类）学习方向？</li>
<li>主动搜索：允许用户根据标签去搜索其他用户<ol>
<li>Redis 缓存</li>
</ol>
</li>
<li>组队<ol>
<li>创建队伍</li>
<li>加入队伍</li>
<li>根据标签查询队伍</li>
<li>邀请其他人</li>
</ol>
</li>
<li>允许用户去修改标签</li>
<li>推荐<ol>
<li>相似度计算算法 + 本地分布式计算</li>
</ol>
</li>
</ol>
<h2 id="技术栈"><a href="#技术栈" class="headerlink" title="技术栈"></a>技术栈</h2><h3 id="前端"><a href="#前端" class="headerlink" title="前端"></a>前端</h3><ol>
<li>Vue 3 开发框架（提交页面开发效率）</li>
<li>Vant UI （基于 Vue 的移动端组件库） （React 版 Zent）</li>
<li>Vite （打包工具，快！）</li>
<li>Nginx 来单机部署</li>
</ol>
<h3 id="后端"><a href="#后端" class="headerlink" title="后端"></a>后端</h3><ol>
<li>Java 编程语言 + SpringBoot 框架</li>
<li>SpringMVC + Mybatis + Mybatis Plus</li>
<li>MySQL 数据库</li>
<li>Redis 缓存</li>
<li>Swagger + Knife4j 接口文档</li>
</ol>
<h2 id="第一期"><a href="#第一期" class="headerlink" title="第一期"></a>第一期</h2><ol>
<li>前端初始化</li>
<li>前端主页 + 组件概览</li>
<li>数据库表设计<ol>
<li>标签表</li>
<li>用户表</li>
</ol>
</li>
<li>开发后端 - 根据标签搜索用户</li>
<li>开发前端 - 根据标签搜索用户</li>
</ol>
<h3 id="前端项目初始化"><a href="#前端项目初始化" class="headerlink" title="前端项目初始化"></a>前端项目初始化</h3><p>用脚手架初始化项目</p>
<ul>
<li>Vue CLI</li>
<li>Vite 脚手架</li>
</ul>
<p>整合组件库 Vant：</p>
<ul>
<li>安装 Vant</li>
<li>按需引入 <a target="_blank" rel="noopener" href="https://vant-ui.github.io/vant/#/zh-CN/quickstart">指令参考官方文档</a></li>
</ul>
<p>开发页面经验：</p>
<ol>
<li>多参考</li>
<li>从整体到局部</li>
<li>先想清楚页面要做成什么样子，再写代码</li>
</ol>
<h3 id="前端主页-组件概览"><a href="#前端主页-组件概览" class="headerlink" title="前端主页 + 组件概览"></a>前端主页 + 组件概览</h3><h4 id="设计"><a href="#设计" class="headerlink" title="设计"></a>设计</h4><ol>
<li>导航条：展示当前页面</li>
<li>主页搜索框 -&gt; 推荐页 -&gt; 搜索结果页</li>
<li>内容</li>
<li>tab栏：<ul>
<li>主页（推荐页 + 广告）<ul>
<li>搜索框</li>
<li>banner</li>
<li>推荐信息流</li>
</ul>
</li>
<li>队伍页</li>
<li>用户页</li>
</ul>
</li>
</ol>
<h4 id="开发"><a href="#开发" class="headerlink" title="开发"></a>开发</h4><p>很多页面要复用组件 &#x2F; 样式，重复写很麻烦，不利于维护，所以抽象一个通用的布局（Layout）</p>
<h3 id="数据库表设计"><a href="#数据库表设计" class="headerlink" title="数据库表设计"></a>数据库表设计</h3><p>标签的分类（要有哪些标签，怎么把标签分类）</p>
<h4 id="标签表（分类表）"><a href="#标签表（分类表）" class="headerlink" title="标签表（分类表）"></a>标签表（分类表）</h4><p>建议用标签不要用分类。更灵活</p>
<ul>
<li>性别 ： 男，女</li>
<li>方向：Java、Python、C++</li>
<li>目标：考研、春招、秋招、考公、竞赛</li>
<li>身份：大学生、待业、研究生</li>
<li>状态：乐观、有点丧、一般、单身、已婚、有对象</li>
<li>【用户自定义标签】？</li>
</ul>
<p>字段：</p>
<ul>
<li><p>id int 主键</p>
</li>
<li><p>标签名 varchar 非空 （必须唯一，唯一索引）</p>
</li>
<li><p>userId 上传标签的用户 int （普通索引）</p>
</li>
<li><p>parentId 父标签 int（分类）</p>
</li>
<li><p>isParent 是否为父标签 tinyint</p>
</li>
<li><p>creatTime 创建时间 datetime</p>
</li>
<li><p>updateTime 更新时间 datetime</p>
</li>
<li><p>isDelete 是否删除 tinyint</p>
</li>
</ul>
<p>怎么查询所有标签，并且把标签分好组？能实现 √</p>
<p>根据父标签查询子标签，根据id查询 √</p>
<p>SQL语言分类：</p>
<p>DDL define 建表、操作表</p>
<p>DML manager 更新删除数据，影响实际表里的内容</p>
<p>DCL control 控制、权限</p>
<p>DQL query 查询</p>
<h4 id="用户表"><a href="#用户表" class="headerlink" title="用户表"></a>用户表</h4><p>用户有哪些标签？</p>
<ol>
<li>直接在用户表补充 tags 字段，[‘java’, ‘男’]存 JSON 字符串<ol>
<li>优点：查询方便，不用新建关联表，标签是用户的固有属性（除了该系统、其他系统可能也要使用），节省开发成本。</li>
<li>缺点：用户表多一列，会有点</li>
<li>哪怕性能低，可以用缓存</li>
</ol>
</li>
<li>加一个关联表，记录用户和标签的关系<ol>
<li>优点：查询灵活，可以正查反查</li>
<li>缺点：要多建一个表、多维护一个表</li>
<li>重点：企业大项目开发中尽量减少关联查询，很影响扩展性，而且会影响查询性能</li>
</ol>
</li>
</ol>
<h3 id="开发后端接口"><a href="#开发后端接口" class="headerlink" title="开发后端接口"></a>开发后端接口</h3><p>搜索标签：</p>
<ol>
<li>允许用户传入多个标签，多个标签都存在才搜索出来 and。like %Java% and like %C++%</li>
<li>允许用户传入多个标签，有任何一个标签存在就能搜索出来 or。like %Java% or like %C++%</li>
</ol>
<p>两种方式：</p>
<ol>
<li>SQL查询</li>
<li>内存查询</li>
</ol>
<h3 id="用户中心来集中提供用户的检索、操作、登录、鉴权等等"><a href="#用户中心来集中提供用户的检索、操作、登录、鉴权等等" class="headerlink" title="用户中心来集中提供用户的检索、操作、登录、鉴权等等"></a>用户中心来集中提供用户的检索、操作、登录、鉴权等等</h3><h2 id="第二期"><a href="#第二期" class="headerlink" title="第二期"></a>第二期</h2><ol>
<li>前端开发（搜索页面、用户信息页、用户信息修改页）</li>
<li>前端整合路由</li>
<li>后端整合Swagger + Knife4j 接口文档</li>
<li>存量用户信息导入及同步（爬虫）</li>
</ol>
<h3 id="Java-8"><a href="#Java-8" class="headerlink" title="Java 8"></a>Java 8</h3><ol>
<li>stream &#x2F; parallelStream 流式处理</li>
<li>Optional 可选类</li>
</ol>
<h3 id="前端整合路由"><a href="#前端整合路由" class="headerlink" title="前端整合路由"></a>前端整合路由</h3><p>点击去Vue-Router 官方文档 -&gt;&gt;&gt; <a class="btn-anzhiyu outline orange larger" target="_blank" rel="noopener" href="https://router.vuejs.org/zh/guide/" 
  title="Vue-Router"><i class="anzhiyufont anzhiyu-icon-circle-arrow-right"></i><span>Vue-Router</span></a></p>
<p>Vue - Router 其实就是帮助你根据不同的 url 来展示不同的页面（组件），不用自己写 if &#x2F; else</p>
<p>路由配置影响整个项目，所以建议单独用 config 目录、单独的配置文件去集中定义和管理。</p>
<p>有些组件库可能自带了和 Vue-Router 的整合，所以尽量先看组件文档，省去自己写的时间。</p>
<h2 id="第三期"><a href="#第三期" class="headerlink" title="第三期"></a>第三期</h2><p>计划：</p>
<ol>
<li>后端整合Swagger + Knife4j 接口文档</li>
<li>存量用户信息导入及同步（爬虫）</li>
<li>前后端联调：搜索页面、用户信息页、用户信息修改页</li>
<li>标签整理、部分细节优化</li>
</ol>
<h3 id="后端整合Swagger-Knife4j-接口文档"><a href="#后端整合Swagger-Knife4j-接口文档" class="headerlink" title="后端整合Swagger + Knife4j 接口文档"></a>后端整合Swagger + Knife4j 接口文档</h3><p>什么是接口文档？写接口信息的文档，每条接口包括：</p>
<ul>
<li>请求参数</li>
<li>响应参数<ul>
<li>错误码</li>
</ul>
</li>
<li>接口地址</li>
<li>接口名称</li>
<li>请求类型</li>
<li>请求格式</li>
<li>备注</li>
</ul>
<p>谁用？一般是后端或者负责人提供，后端前端都要使用</p>
<p>为什么需要接口文档？</p>
<ul>
<li>有个书面内容（背书或者归档），便于大家参考和查阅，便于沉淀和维护，拒绝口口相传</li>
<li>有个文档方便与前端和后端开发对接，前端后端联调的&#x3D;&#x3D;介质&#x3D;&#x3D;。后端&#x3D;&gt;接口文档&lt;&#x3D;前端</li>
<li>好的接口文档支持在线调试、在线测试，可以作为工具提高我们的开发测试效率</li>
</ul>
<p>怎么做接口文档？</p>
<ul>
<li>手写（比如腾讯文档、Markdown笔记）</li>
<li>自动化接口文档生成：Swagger、Postman（侧重接口管理）；apifox，apipost，eolink（国产）</li>
</ul>
<p>Swagger原理：</p>
<ol>
<li>自定义 Swagger 配置类</li>
<li>定义需要生成接口文档的代码位置（Controller）</li>
</ol>
<p>千万注意：线上环境不要把接口暴露出去</p>
<blockquote>
<p>[!NOTE]</p>
<p>可直接引入knife4j，其集成了 Swagger 和 openAPI &#x3D;&#x3D;引入请见官方文档&#x3D;&#x3D;。</p>
</blockquote>
<p>FeHelper 前端插件 推荐安装</p>
<h2 id="第四期"><a href="#第四期" class="headerlink" title="第四期"></a>第四期</h2><p>计划：</p>
<ol>
<li>页面和功能开发（搜索页面、用户信息、用户修改页面）</li>
<li>改造用户中心，把单机登录改为分布式 session 登录</li>
<li>标签的整理、细节的优化</li>
</ol>
<h3 id="前端页面跳转传值"><a href="#前端页面跳转传值" class="headerlink" title="前端页面跳转传值"></a>前端页面跳转传值</h3><ol>
<li>query &#x3D;&gt; url searchParams, url 后附加参数（传递值长度有限）</li>
<li>vuex （全局状态管理），搜索页将关键词塞到状态中，搜索结果页从状态中取值</li>
</ol>
<p>以下代码使用参考Vue Router官方文档 -&gt;&gt;&gt; <a class="btn-anzhiyu outline orange larger" target="_blank" rel="noopener" href="https://router.vuejs.org/zh/" 
  title="Vue Router"><i class="anzhiyufont anzhiyu-icon-circle-arrow-right"></i><span>Vue Router</span></a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 字符串路径</span></span><br><span class="line">router.<span class="title function_">push</span>(<span class="string">&#x27;/user/eduardo&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//带有路径的对象</span></span><br><span class="line">router.<span class="title function_">push</span>(&#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/user/eduardo&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//命名路由，并加上参数，让路由建立 url</span></span><br><span class="line">router.<span class="title function_">push</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;user&#x27;</span>,</span><br><span class="line">    <span class="attr">params</span>:&#123;</span><br><span class="line">        <span class="attr">username</span>: <span class="string">&#x27;eduardo&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 带查询参数，结果是 /register?plan=private</span></span><br><span class="line">router.<span class="title function_">push</span>(&#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/register&#x27;</span>,</span><br><span class="line">    <span class="attr">query</span>:&#123;</span><br><span class="line">        <span class="attr">plan</span>: <span class="string">&#x27;private&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//带 hash，结果是 /about#team</span></span><br><span class="line">router.<span class="title function_">push</span>(&#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/about&#x27;</span>,</span><br><span class="line">    <span class="attr">hash</span>: <span class="string">&#x27;#team&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h2 id="整合Axios"><a href="#整合Axios" class="headerlink" title="整合Axios"></a>整合Axios</h2><p>点击去官方文档 -&gt;&gt;&gt; <a class="btn-anzhiyu outline orange larger" target="_blank" rel="noopener" href="https://www.axios-http.cn/" 
  title="Axios中文文档"><i class="anzhiyufont anzhiyu-icon-circle-arrow-right"></i><span>Axios中文文档</span></a></p>
<h2 id="Session-共享"><a href="#Session-共享" class="headerlink" title="Session 共享"></a>Session 共享</h2><h3 id="Cookie-范围"><a href="#Cookie-范围" class="headerlink" title="Cookie 范围"></a>Cookie 范围</h3><p>种 session 的时候注意范围， Springboot 项目中可以通过 cookie。domain 来配置。（3.0版本之后不需要配置）</p>
<p>比如两个域名：</p>
<ul>
<li>aaa.abeibiiji.com</li>
<li>bbb.abeibiji.com</li>
</ul>
<p>如果要共享cookie ，可以种一个更高层的公共域名，比如 abeibiji.com</p>
<h3 id="为什么需要共享？"><a href="#为什么需要共享？" class="headerlink" title="为什么需要共享？"></a>为什么需要共享？</h3><p>思考：为什么服务器A登录后， 请求发送到服务器B，不认识该用户？</p>
<p>原因：</p>
<ol>
<li>用户在A登录，所以 session （用户登录信息）存在了 A 上</li>
<li>结果请求 B 时，B 没有用户信息，所以不认识。</li>
</ol>
<p>如图：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://abei-1256557411.cos.ap-chengdu.myqcloud.com/blogs/202406032157631.png" alt="image-20240603215713650" style="zoom:50%;" />

<p>解决方案：&#x3D;&#x3D;共享存储&#x3D;&#x3D;，而不是把数据放到单台服务器的内存中</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://abei-1256557411.cos.ap-chengdu.myqcloud.com/blogs/202406032158186.png" alt="image-20240603215816129" style="zoom:50%;" />

<h3 id="如何共享存储"><a href="#如何共享存储" class="headerlink" title="如何共享存储"></a>如何共享存储</h3><p>核心思想：把数据放到同一个地方去管理</p>
<ol>
<li>Redis（基于内存的 K&#x2F;V 数据库）此处选择 Redis，因为用户信息读取 &#x2F; 是否登录的判断极其 &#x3D;&#x3D;频繁&#x3D;&#x3D;，Redis 基于内存，读写性能很高，简单的数据单机 qps 5w - 10w</li>
<li>MySQL</li>
<li>文件服务器 ceph</li>
</ol>
<h3 id="Session-共享实现"><a href="#Session-共享实现" class="headerlink" title="Session 共享实现"></a>Session 共享实现</h3><ol>
<li><p>安装 <a class="btn-anzhiyu outline orange larger" target="_blank" rel="noopener" href="https://redis.io" 
  title="Redis"><i class="anzhiyufont anzhiyu-icon-circle-arrow-right"></i><span>Redis</span></a></p>
</li>
<li><p>安装 Redis 管理工具 <a class="btn-anzhiyu outline orange larger" target="_blank" rel="noopener" href="https://quick123.net" 
  title="quick redis"><i class="anzhiyufont anzhiyu-icon-circle-arrow-right"></i><span>quick redis</span></a></p>
</li>
<li><p>引入 Redis：</p>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	&lt;依赖具有时效性，具体依赖参考maven仓库&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li>引入 spring-session 和 redis 的整合，使得自动将session 存储到 redis 中。</li>
</ol>
<h2 id="其他单点登陆方案"><a href="#其他单点登陆方案" class="headerlink" title="其他单点登陆方案"></a>其他单点登陆方案</h2><p>常用的就是 JWT</p>
<p>Redis Session 对比 JWT 的优缺点 <a class="btn-anzhiyu outline orange larger" target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/108999941" 
  title="基于jwt和session的区别和优缺点"><i class="anzhiyufont anzhiyu-icon-circle-arrow-right"></i><span>基于jwt和session的区别和优缺点</span></a></p>
<h2 id="开发主页"><a href="#开发主页" class="headerlink" title="开发主页"></a>开发主页</h2><p>直接使用的 card 组件列表展示。</p>
<p>模拟 100万用户数据查询。</p>
<h3 id="100-万用户数据插入方式"><a href="#100-万用户数据插入方式" class="headerlink" title="100 万用户数据插入方式"></a>100 万用户数据插入方式</h3><ol>
<li>用编译器的可视化界面导入：适合一次性导入，数据量可控</li>
<li>编写程序：for 循环，建议分批，不要一把梭哈（可以用接口来控制）。&#x3D;&#x3D;要保证可控，幂等，注意线上环境和测试环境是有区别的！&#x3D;&#x3D;</li>
<li>执行 SQL 语句：适用于小数据量</li>
</ol>
<h3 id="编写一次性任务"><a href="#编写一次性任务" class="headerlink" title="编写一次性任务"></a>编写一次性任务</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用 for 循环遍历插入数据</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 批量插入用户数据</span></span><br><span class="line"><span class="comment">     * 写在了 测试类里面，程序运行时记得注释，不然会自动运行测试类！！！</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doInsertUsers</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 检测运行时间</span></span><br><span class="line">        <span class="type">StopWatch</span> <span class="variable">stopWatch</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StopWatch</span>();</span><br><span class="line">        stopWatch.start();</span><br><span class="line">        <span class="keyword">final</span> <span class="type">int</span> <span class="variable">INSERT_NUM</span> <span class="operator">=</span> <span class="number">1000</span>;</span><br><span class="line">        <span class="comment">// 使用数组 分批插入 效率较高</span></span><br><span class="line">        ArrayList&lt;User&gt; userList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; INSERT_NUM; i++) &#123;</span><br><span class="line">            <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">            user.setUsername(<span class="string">&quot;假用户&quot;</span> + i);</span><br><span class="line">            user.setUserAccount(<span class="string">&quot;假用户&quot;</span> + i);</span><br><span class="line">            user.setAvatarUrl(<span class="string">&quot;https://abei-1256557411.cos.ap-chengdu.myqcloud.com/blogs/202405102124088.jpeg&quot;</span>);</span><br><span class="line">            user.setGender(<span class="string">&quot;男&quot;</span>);</span><br><span class="line">            user.setUserPassword(<span class="string">&quot;11111111&quot;</span>);</span><br><span class="line">            user.setUserPhone(<span class="string">&quot;12345678&quot;</span>);</span><br><span class="line">            user.setUserEmail(<span class="string">&quot;12345678@qq.com&quot;</span>);</span><br><span class="line">            user.setUserStatus(<span class="number">0</span>);</span><br><span class="line">            user.setIsDelete(<span class="number">0</span>);</span><br><span class="line">            user.setUserRole(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">            user.setUserTags(<span class="string">&quot;[\&quot;Java\&quot;]&quot;</span>);</span><br><span class="line">            user.setUserProfile(<span class="string">&quot;这是假用户&quot;</span>);</span><br><span class="line">            user.setUserCode(<span class="string">&quot;99999999&quot;</span>);</span><br><span class="line">            userList.add(user);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 使用 Service层的saveBatch批量插入数据</span></span><br><span class="line">        userService.saveBatch(userList,<span class="number">100</span>);</span><br><span class="line">        stopWatch.stop();</span><br><span class="line">        System.out.println(stopWatch.getTotalTimeMillis());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用多线程插入数据</span></span><br><span class="line"></span><br><span class="line">	！这里要在前面声明自定义线程池</span><br><span class="line">    <span class="comment">// 自定义线程池</span></span><br><span class="line">    <span class="comment">//CPU 密集型：分配的核心线程数 = CPU -1</span></span><br><span class="line">    <span class="comment">// IO 密集型：分配的核心线程数可以大于CPU核数</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">ExecutorService</span> <span class="variable">executorService</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(<span class="number">60</span>,<span class="number">1000</span>,<span class="number">10000</span>,TimeUnit.MINUTES, <span class="keyword">new</span> <span class="title class_">ArrayBlockingQueue</span>&lt;&gt;(<span class="number">10000</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 并发批量插入用户数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doConcurrencyInsertUsers</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">StopWatch</span> <span class="variable">stopWatch</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StopWatch</span>();</span><br><span class="line">        stopWatch.start();</span><br><span class="line">        <span class="keyword">final</span> <span class="type">int</span> <span class="variable">INSERT_NUM</span> <span class="operator">=</span> <span class="number">100000</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">batchSize</span> <span class="operator">=</span> <span class="number">5000</span>;</span><br><span class="line">        <span class="comment">// 分二十组</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        List&lt;CompletableFuture&lt;Void&gt;&gt; futureList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">20</span>; i++) &#123;</span><br><span class="line">            List&lt;User&gt; userList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            <span class="keyword">while</span>(<span class="literal">true</span>) &#123;</span><br><span class="line">                j++;</span><br><span class="line">                <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">                user.setUsername(<span class="string">&quot;假用户&quot;</span>);</span><br><span class="line">                user.setUserAccount(<span class="string">&quot;假用户&quot;</span>);</span><br><span class="line">                user.setAvatarUrl(<span class="string">&quot;https://abei-1256557411.cos.ap-chengdu.myqcloud.com/blogs/202405102124088.jpeg&quot;</span>);</span><br><span class="line">                user.setGender(<span class="string">&quot;男&quot;</span>);</span><br><span class="line">                user.setUserPassword(<span class="string">&quot;1234567890&quot;</span>);</span><br><span class="line">                user.setUserPhone(<span class="string">&quot;12345678&quot;</span>);</span><br><span class="line">                user.setUserEmail(<span class="string">&quot;12345678&quot;</span>);</span><br><span class="line">                user.setUserStatus(<span class="number">0</span>);</span><br><span class="line">                user.setIsDelete(<span class="number">0</span>);</span><br><span class="line">                user.setUserRole(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">                user.setUserTags(<span class="string">&quot;[\&quot;Java\&quot;]&quot;</span>);</span><br><span class="line">                user.setUserProfile(<span class="string">&quot;这是假用户&quot;</span>);</span><br><span class="line">                user.setUserCode(<span class="string">&quot;99999999&quot;</span>);</span><br><span class="line">                userList.add(user);</span><br><span class="line">                <span class="keyword">if</span> (j % batchSize == <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 异步执行</span></span><br><span class="line">            <span class="comment">// 从自带的线程池中取</span></span><br><span class="line">            CompletableFuture&lt;Void&gt; future = CompletableFuture.runAsync(() -&gt; &#123;</span><br><span class="line">                userService.saveBatch(userList,batchSize);</span><br><span class="line">            &#125;);</span><br><span class="line">            futureList.add(future);</span><br><span class="line"><span class="comment">//             从自定义的线程池中取</span></span><br><span class="line"><span class="comment">//            CompletableFuture&lt;Void&gt; future = CompletableFuture.runAsync(() -&gt; &#123;</span></span><br><span class="line"><span class="comment">//                userService.saveBatch(userList,batchSize);</span></span><br><span class="line"><span class="comment">//            &#125;,executorService);</span></span><br><span class="line"><span class="comment">//            futureList.add(future);</span></span><br><span class="line">            </span><br><span class="line">                </span><br><span class="line">        &#125;</span><br><span class="line">        CompletableFuture.allOf(futureList.toArray(<span class="keyword">new</span> <span class="title class_">CompletableFuture</span>[]&#123;&#125;)).join();</span><br><span class="line">        stopWatch.stop();</span><br><span class="line">        System.out.println(stopWatch.getTotalTimeMillis());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="使用缓存优化性能"><a href="#使用缓存优化性能" class="headerlink" title="使用缓存优化性能"></a>使用缓存优化性能</h2><p>目前首页数据加载时间：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://abei-1256557411.cos.ap-chengdu.myqcloud.com/blogs/202406041544956.png" alt="image-20240604154458838"></p>
<p>添加缓存后的加载时间：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://abei-1256557411.cos.ap-chengdu.myqcloud.com/blogs/202406041720507.png" alt="image-20240604172027312"></p>
<p>数据库慢？预先把数据查出来，放到一个更快读取的地方，不用再查数据库了。（缓存）</p>
<p>防止第一个用户的数据加载是从数据库中取出，从而导致第一个用户或者前几个用户的体验较差。</p>
<ul>
<li>预加载缓存，定时更新缓存。（定时任务）</li>
</ul>
<p>多个机器都要执行任务么？（分布式锁：控制同一时间只有一台机器去执行定时任务，其他机器不用重复执行了）</p>
<h3 id="缓存"><a href="#缓存" class="headerlink" title="缓存"></a>缓存</h3><p>提前把数据取出来保存好（通常保存到读写更快的介质，比如内存），就可以更快的读写。</p>
<p>缓存的实现：</p>
<ul>
<li>Redis (分布式缓存)</li>
<li>memcached (分布式)</li>
<li>Etcd（云原生架构的一个分布式存储，&#x3D;&#x3D;存储配置&#x3D;&#x3D;，扩容能力强）</li>
</ul>
<hr>
<ul>
<li>ehcache（单机）</li>
<li>本地缓存（Java 内存 Map ）</li>
<li>Caffeine（Java 内存缓存，高性能）</li>
<li>Google Guava</li>
</ul>
<h2 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h2><blockquote>
<p>定义 ： NoSQL 数据库</p>
<p>key - value 存储系统（区别于 MySQL，他存储的是键值对）</p>
</blockquote>
<h3 id="Redis-数据结构"><a href="#Redis-数据结构" class="headerlink" title="Redis 数据结构"></a>Redis 数据结构</h3><p>String 字符串类型：name:“kele”</p>
<p>List 列表：names:[“kele”,”abei”,”abei”]</p>
<p>Set 集合：names:[“kele”,”abei”] (值不能重复)</p>
<p>Hash 哈希：nameAge：{“kele”:1,”abei”:2} (键不能重复)</p>
<p>Zset 集合：names:{kele - 9, abei - 12} (每个值都要指定一个分数。适合做排行榜)</p>
<hr>
<p>bloomfilter（布隆过滤器，主要从大量的数据中快速过滤值，比如拦截邮件黑名单）</p>
<p>geo （计算地理位置）</p>
<p>hyperloglog （pv &#x2F; uv）</p>
<p>pub &#x2F; sub （发布订阅，类似消息队列） </p>
<p>BitMap （10101010010100011110101）</p>
<h3 id="Java里的实现方式"><a href="#Java里的实现方式" class="headerlink" title="Java里的实现方式"></a>Java里的实现方式</h3><h4 id="※Spring-Data-Redis"><a href="#※Spring-Data-Redis" class="headerlink" title="※Spring Data Redis"></a>※Spring Data Redis</h4><p>通用的数据访问框架，定义了一组增删改查的接口。</p>
<p>引入</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">引入版本需于Spring Boot 的版本一致</span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-data-redis --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>配置 Redis 地址</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">     <span class="comment"># Redis</span></span><br><span class="line">     <span class="attr">data:</span></span><br><span class="line">       <span class="attr">redis:</span></span><br><span class="line">         <span class="attr">port:</span> <span class="number">6379</span></span><br><span class="line">         <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">         <span class="attr">database:</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>



<h4 id="Jedis"><a href="#Jedis" class="headerlink" title="Jedis"></a>Jedis</h4><p>独立于 Spring 操作 Redis 的 Java 客户端</p>
<p>要配合 Jedis Pool 使用</p>
<h4 id="Redisson"><a href="#Redisson" class="headerlink" title="Redisson"></a>Redisson</h4><p>分布式操作 Redis 的 Java 客户端，让你像在使用本地集合一样操作 Redis （分布式 Redis 数据网格）</p>
<h4 id="Lettuce"><a href="#Lettuce" class="headerlink" title="Lettuce"></a>Lettuce</h4><p>高阶的操作 Redis 的 Java 客户端</p>
<p>对比：</p>
<ol>
<li>如果你用的是 Spring ，并且没有过多的定制化要求，可以用Spring Data Redis，最方便</li>
<li>如果你用的不是Spring ，并且追求简单，并且没有过高的性能要求，可以用 Jedis + Jedis Pool</li>
<li>如果你的项目不是 Spring，并且追求高性能、高定制化，可以用 Lettuce。支持异步、连接池</li>
</ol>
<hr>
<ol>
<li>如果你的项目是分布式的，需要用到一些分布式的特性（比如，分布式锁、分布式集合），推荐用 redisson</li>
</ol>
<h3 id="设计缓存-Key"><a href="#设计缓存-Key" class="headerlink" title="设计缓存 Key"></a>设计缓存 Key</h3><p>不同用户看到的数据不同</p>
<p>systemId.moduleId.func&lt; options &gt; （不要和别人冲突）</p>
<p>redBirds:user:recommend:userId</p>
<div class="tip key"><p>redis内存不能无限增加，一定要设置过期时间！！！  </p>
</div>

<h3 id="将推荐改为缓存实现"><a href="#将推荐改为缓存实现" class="headerlink" title="将推荐改为缓存实现"></a>将推荐改为缓存实现</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">@GetMapping(&quot;/recommend&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;IPage&lt;User&gt;&gt; <span class="title function_">recommendUsers</span><span class="params">(<span class="meta">@RequestParam(required = false)</span> List&lt;String&gt; tagNameList,<span class="type">long</span> pageSize,<span class="type">long</span> pageNum)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (CollectionUtils.isEmpty(tagNameList)) &#123;</span><br><span class="line">            <span class="comment">// 直接查询数据库所有数据并返回</span></span><br><span class="line">            QueryWrapper&lt;User&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">            IPage&lt;User&gt; userList = userService.page(<span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(pageNum,pageSize),queryWrapper);</span><br><span class="line">            <span class="keyword">return</span> ResultUtils.success(userList);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改后</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/recommend&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;IPage&lt;User&gt;&gt; <span class="title function_">recommendUsers</span><span class="params">(<span class="meta">@RequestParam(required = false)</span> List&lt;String&gt; tagNameList,<span class="type">long</span> pageSize,<span class="type">long</span> pageNum,HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">loginUser</span> <span class="operator">=</span> userService.getLoginUser(request);</span><br><span class="line">        <span class="type">String</span> <span class="variable">redisKey</span> <span class="operator">=</span> String.format(<span class="string">&quot;redBirds:user:recommend:%s&quot;</span>, loginUser.getId());</span><br><span class="line">        ValueOperations&lt;String, Object&gt; valueOperations = redisTemplate.opsForValue();</span><br><span class="line">        <span class="comment">// 如果有缓存，直接读缓存</span></span><br><span class="line">        Page&lt;User&gt; userPage = (Page&lt;User&gt;) valueOperations.get(redisKey);</span><br><span class="line">        <span class="keyword">if</span>(userPage != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> ResultUtils.success(userPage);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 无缓存，查数据库</span></span><br><span class="line">        QueryWrapper&lt;User&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">        IPage&lt;User&gt; userList = userService.page(<span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(pageNum,pageSize),queryWrapper);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            valueOperations.set(redisKey,userList,<span class="number">10000</span>, TimeUnit.MICROSECONDS); <span class="comment">// 记得设置过期时间</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;redis key set error : UserController - 150&quot;</span>,e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(userList);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<h3 id="缓存预热"><a href="#缓存预热" class="headerlink" title="缓存预热"></a>缓存预热</h3><p>问题：第一个用户访问很慢，怎么优化？</p>
<p>缓存预热的优缺点：</p>
<ol>
<li>解决第一个用户访问慢的问题</li>
</ol>
<p>缺点：</p>
<ol>
<li>增加开发成本（额外开发、设计）</li>
<li>预热的时机和时间如果错了，有可能你缓存的数据不对或者太老</li>
<li>需要占用额外空间</li>
</ol>
<div class="tip key"><p>分析优缺点的时候，要打开思路，从整个项目从 0 到 1 的链路上去分析</p>
</div>



<p>注意点：</p>
<ol>
<li>缓存预热的意义（新增少，总用户多）</li>
<li>缓存的空间不能太大，要预留给其他缓存空间</li>
<li>缓存数据的周期</li>
</ol>
<h4 id="怎么缓存预热？"><a href="#怎么缓存预热？" class="headerlink" title="怎么缓存预热？"></a>怎么缓存预热？</h4><ol>
<li>定时</li>
<li>模拟触发（手动触发）</li>
</ol>
<h4 id="定时任务实现"><a href="#定时任务实现" class="headerlink" title="定时任务实现"></a>定时任务实现</h4><ol>
<li>Spring Scheduler （spring boot 默认整合了）</li>
<li>Quartz （独立于 Spring 存在的定时任务框架）</li>
<li>XXL - Job 之类的分布式任务调度平台（界面 + sdk）</li>
</ol>
<p>用定时任务，每天刷新所有用户的推荐列表。</p>
<p>第一种方式实现：</p>
<ol>
<li>主类开启 @EnableScheduling</li>
<li>给要定时执行的方法添加 @Scheduling 注解，指定 cron 表达式或者执行频率</li>
</ol>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://abei-1256557411.cos.ap-chengdu.myqcloud.com/blogs/avatar.jpeg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://abei-1256557411.cos.ap-chengdu.myqcloud.com/blogs/avatar.jpeg" title="头像" alt="头像"></a><div class="post-copyright__author_name">Abei</div><div class="post-copyright__author_desc">学无止境，烟酒生活</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://abeibiji.cn/2024/05/11/%E4%BC%99%E4%BC%B4%E5%8C%B9%E9%85%8D%E7%B3%BB%E7%BB%9F/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://abeibiji.cn/2024/05/11/伙伴匹配系统/')">伙伴匹配系统</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="/pay/wechat.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/pay/wechat.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/pay/zhifubao.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/pay/zhifubao.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://abeibiji.cn/2024/05/11/%E4%BC%99%E4%BC%B4%E5%8C%B9%E9%85%8D%E7%B3%BB%E7%BB%9F/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=伙伴匹配系统&amp;url=http://abeibiji.cn/2024/05/11/%E4%BC%99%E4%BC%B4%E5%8C%B9%E9%85%8D%E7%B3%BB%E7%BB%9F/&amp;pic=https://abei-1256557411.cos.ap-chengdu.myqcloud.com/blogs/202406032223397.png" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="null" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://abeibiji.cn" target="_blank">阿北笔记</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>项目实践<span class="tagsPageCount">3</span></a><a class="post-meta__box__tags" href="/tags/Java/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Java<span class="tagsPageCount">4</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://abei-1256557411.cos.ap-chengdu.myqcloud.com/blogs/202405132306790.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/05/09/%E6%8C%87%E4%BB%A4%E8%AE%B0%E5%BD%95%E5%AD%98%E6%A1%A3/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://abei-1256557411.cos.ap-chengdu.myqcloud.com/blogs/202405092323429.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">工具指令存档</div></div></a></div><div class="next-post pull-right"><a href="/2024/05/12/openCV%E5%AD%A6%E4%B9%A0/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://abei-1256557411.cos.ap-chengdu.myqcloud.com/blogs/202405291424669.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">openCV 学习</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2024/05/08/%E7%94%A8%E6%88%B7%E4%B8%AD%E5%BF%83/" title="用户中心"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://abei-1256557411.cos.ap-chengdu.myqcloud.com/blogs/202405091848129.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-05-08</div><div class="title">用户中心</div></div></a></div><div><a href="/2024/05/28/API%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0/" title="API开发平台"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://abei-1256557411.cos.ap-chengdu.myqcloud.com/blogs/202405291414086.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-05-28</div><div class="title">API开发平台</div></div></a></div><div><a href="/2024/05/29/JVM%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="JVM学习笔记"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://abei-1256557411.cos.ap-chengdu.myqcloud.com/blogs/202405290927167.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-05-29</div><div class="title">JVM学习笔记</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://abei-1256557411.cos.ap-chengdu.myqcloud.com/blogs/avatar.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" alt="status"/></div></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">这有关于<b style="color:#fff">踩坑、旅行、吐槽</b>的个人生活记录，还有<b style="color:#fff">技术学习</b>和<b style="color:#fff">阅读分享</b>。</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">相信你可以在这里解决遇到的<b style="color:#fff">问题</b>，获取宝贵的<b style="color:#fff">踩坑经验</b>。</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/about"><h1 class="author-info__name">Abei</h1><div class="author-info__desc">学无止境，烟酒生活</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://qm.qq.com/cgi-bin/qm/qr?k=okp4sxwdxgy0r6hgoueO-1zWTPl044RT" target="_blank" title="QQ"><i class="anzhiyufont anzhiyu-icon-qq"></i></a></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BC%99%E4%BC%B4%E5%8C%B9%E9%85%8D%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.</span> <span class="toc-text">伙伴匹配系统</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"><span class="toc-number">1.1.</span> <span class="toc-text">需求分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%80%E6%9C%AF%E6%A0%88"><span class="toc-number">1.2.</span> <span class="toc-text">技术栈</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF"><span class="toc-number">1.2.1.</span> <span class="toc-text">前端</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF"><span class="toc-number">1.2.2.</span> <span class="toc-text">后端</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E6%9C%9F"><span class="toc-number">1.3.</span> <span class="toc-text">第一期</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E9%A1%B9%E7%9B%AE%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-number">1.3.1.</span> <span class="toc-text">前端项目初始化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E4%B8%BB%E9%A1%B5-%E7%BB%84%E4%BB%B6%E6%A6%82%E8%A7%88"><span class="toc-number">1.3.2.</span> <span class="toc-text">前端主页 + 组件概览</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">设计</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%80%E5%8F%91"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">开发</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E8%AE%BE%E8%AE%A1"><span class="toc-number">1.3.3.</span> <span class="toc-text">数据库表设计</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%87%E7%AD%BE%E8%A1%A8%EF%BC%88%E5%88%86%E7%B1%BB%E8%A1%A8%EF%BC%89"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">标签表（分类表）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E8%A1%A8"><span class="toc-number">1.3.3.2.</span> <span class="toc-text">用户表</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E5%90%8E%E7%AB%AF%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.3.4.</span> <span class="toc-text">开发后端接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E4%B8%AD%E5%BF%83%E6%9D%A5%E9%9B%86%E4%B8%AD%E6%8F%90%E4%BE%9B%E7%94%A8%E6%88%B7%E7%9A%84%E6%A3%80%E7%B4%A2%E3%80%81%E6%93%8D%E4%BD%9C%E3%80%81%E7%99%BB%E5%BD%95%E3%80%81%E9%89%B4%E6%9D%83%E7%AD%89%E7%AD%89"><span class="toc-number">1.3.5.</span> <span class="toc-text">用户中心来集中提供用户的检索、操作、登录、鉴权等等</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E6%9C%9F"><span class="toc-number">1.4.</span> <span class="toc-text">第二期</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Java-8"><span class="toc-number">1.4.1.</span> <span class="toc-text">Java 8</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E6%95%B4%E5%90%88%E8%B7%AF%E7%94%B1"><span class="toc-number">1.4.2.</span> <span class="toc-text">前端整合路由</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E6%9C%9F"><span class="toc-number">1.5.</span> <span class="toc-text">第三期</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E6%95%B4%E5%90%88Swagger-Knife4j-%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3"><span class="toc-number">1.5.1.</span> <span class="toc-text">后端整合Swagger + Knife4j 接口文档</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E6%9C%9F"><span class="toc-number">1.6.</span> <span class="toc-text">第四期</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2%E8%B7%B3%E8%BD%AC%E4%BC%A0%E5%80%BC"><span class="toc-number">1.6.1.</span> <span class="toc-text">前端页面跳转传值</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B4%E5%90%88Axios"><span class="toc-number">1.7.</span> <span class="toc-text">整合Axios</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Session-%E5%85%B1%E4%BA%AB"><span class="toc-number">1.8.</span> <span class="toc-text">Session 共享</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Cookie-%E8%8C%83%E5%9B%B4"><span class="toc-number">1.8.1.</span> <span class="toc-text">Cookie 范围</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E5%85%B1%E4%BA%AB%EF%BC%9F"><span class="toc-number">1.8.2.</span> <span class="toc-text">为什么需要共享？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%85%B1%E4%BA%AB%E5%AD%98%E5%82%A8"><span class="toc-number">1.8.3.</span> <span class="toc-text">如何共享存储</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Session-%E5%85%B1%E4%BA%AB%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.8.4.</span> <span class="toc-text">Session 共享实现</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E5%8D%95%E7%82%B9%E7%99%BB%E9%99%86%E6%96%B9%E6%A1%88"><span class="toc-number">1.9.</span> <span class="toc-text">其他单点登陆方案</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E4%B8%BB%E9%A1%B5"><span class="toc-number">1.10.</span> <span class="toc-text">开发主页</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#100-%E4%B8%87%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE%E6%8F%92%E5%85%A5%E6%96%B9%E5%BC%8F"><span class="toc-number">1.10.1.</span> <span class="toc-text">100 万用户数据插入方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E4%B8%80%E6%AC%A1%E6%80%A7%E4%BB%BB%E5%8A%A1"><span class="toc-number">1.10.2.</span> <span class="toc-text">编写一次性任务</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E7%BC%93%E5%AD%98%E4%BC%98%E5%8C%96%E6%80%A7%E8%83%BD"><span class="toc-number">1.11.</span> <span class="toc-text">使用缓存优化性能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%93%E5%AD%98"><span class="toc-number">1.11.1.</span> <span class="toc-text">缓存</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Redis"><span class="toc-number">1.12.</span> <span class="toc-text">Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Redis-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-number">1.12.1.</span> <span class="toc-text">Redis 数据结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Java%E9%87%8C%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F"><span class="toc-number">1.12.2.</span> <span class="toc-text">Java里的实现方式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%80%BBSpring-Data-Redis"><span class="toc-number">1.12.2.1.</span> <span class="toc-text">※Spring Data Redis</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Jedis"><span class="toc-number">1.12.2.2.</span> <span class="toc-text">Jedis</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Redisson"><span class="toc-number">1.12.2.3.</span> <span class="toc-text">Redisson</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Lettuce"><span class="toc-number">1.12.2.4.</span> <span class="toc-text">Lettuce</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1%E7%BC%93%E5%AD%98-Key"><span class="toc-number">1.12.3.</span> <span class="toc-text">设计缓存 Key</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E6%8E%A8%E8%8D%90%E6%94%B9%E4%B8%BA%E7%BC%93%E5%AD%98%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.12.4.</span> <span class="toc-text">将推荐改为缓存实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%93%E5%AD%98%E9%A2%84%E7%83%AD"><span class="toc-number">1.12.5.</span> <span class="toc-text">缓存预热</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%8E%E4%B9%88%E7%BC%93%E5%AD%98%E9%A2%84%E7%83%AD%EF%BC%9F"><span class="toc-number">1.12.5.1.</span> <span class="toc-text">怎么缓存预热？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.12.5.2.</span> <span class="toc-text">定时任务实现</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/05/30/%E8%8B%B1%E5%9B%BD/" title="英国"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://abei-1256557411.cos.ap-chengdu.myqcloud.com/blogs/202405132306790.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="英国"/></a><div class="content"><a class="title" href="/2024/05/30/%E8%8B%B1%E5%9B%BD/" title="英国">英国</a><time datetime="2024-05-30T10:32:23.000Z" title="发表于 2024-05-30 18:32:23">2024-05-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/05/30/B%E7%AB%99%E7%BD%91%E5%8F%8B%E7%9A%84%E9%A1%B6%E7%BA%A7%E6%96%87%E7%AC%94/" title="B站网友的顶级文笔"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://abei-1256557411.cos.ap-chengdu.myqcloud.com/blogs/202405301238815.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="B站网友的顶级文笔"/></a><div class="content"><a class="title" href="/2024/05/30/B%E7%AB%99%E7%BD%91%E5%8F%8B%E7%9A%84%E9%A1%B6%E7%BA%A7%E6%96%87%E7%AC%94/" title="B站网友的顶级文笔">B站网友的顶级文笔</a><time datetime="2024-05-30T04:37:18.000Z" title="发表于 2024-05-30 12:37:18">2024-05-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/05/29/%E9%95%B0%E4%BB%93/" title="镰仓"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://abei-1256557411.cos.ap-chengdu.myqcloud.com/blogs/202405292214811.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="镰仓"/></a><div class="content"><a class="title" href="/2024/05/29/%E9%95%B0%E4%BB%93/" title="镰仓">镰仓</a><time datetime="2024-05-29T14:13:17.000Z" title="发表于 2024-05-29 22:13:17">2024-05-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/05/29/%E9%97%AF%E8%BF%9B%E5%A6%82%E6%A2%A6%E8%88%AC%E7%9A%84%E6%A8%B1%E8%8A%B1%E4%B8%96%E7%95%8C/" title="闯进如梦般的樱花世界"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://abei-1256557411.cos.ap-chengdu.myqcloud.com/blogs/202405291849676.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="闯进如梦般的樱花世界"/></a><div class="content"><a class="title" href="/2024/05/29/%E9%97%AF%E8%BF%9B%E5%A6%82%E6%A2%A6%E8%88%AC%E7%9A%84%E6%A8%B1%E8%8A%B1%E4%B8%96%E7%95%8C/" title="闯进如梦般的樱花世界">闯进如梦般的樱花世界</a><time datetime="2024-05-29T10:48:45.000Z" title="发表于 2024-05-29 18:48:45">2024-05-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/05/29/JVM%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="JVM学习笔记"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://abei-1256557411.cos.ap-chengdu.myqcloud.com/blogs/202405290927167.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="JVM学习笔记"/></a><div class="content"><a class="title" href="/2024/05/29/JVM%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="JVM学习笔记">JVM学习笔记</a><time datetime="2024-05-29T01:26:05.000Z" title="发表于 2024-05-29 09:26:05">2024-05-29</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="footer_deal"><a class="deal_link" href="/76410006@qq.com" title="email"><i class="anzhiyufont anzhiyu-icon-envelope"></i></a><img class="footer_mini_logo" title="返回顶部" alt="返回顶部" onclick="anzhiyu.scrollToDest(0, 500)" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://abei-1256557411.cos.ap-chengdu.myqcloud.com/blogs/avatar.jpeg" size="50px"/><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/abeifang" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a></div><div id="workboard"><div id="runtimeTextTip"></div></div><div class="footer_custom_text">©2024 - forever By Abei</div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v5.4.0" title="博客框架为Hexo_v5.4.0"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Frame-Hexo.svg" alt="博客框架为Hexo_v5.4.0"/></a><a class="github-badge" target="_blank" href="https://blog.anheyu.com/" style="margin-inline:5px" data-title="本站使用AnZhiYu主题" title="本站使用AnZhiYu主题"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.9/img/Theme-AnZhiYu-2E67D3.svg" alt="本站使用AnZhiYu主题"/></a></p></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">21</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">14</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">5</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://qm.qq.com/cgi-bin/qm/qr?k=okp4sxwdxgy0r6hgoueO-1zWTPl044RT" title="博主"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博主"/><span class="back-menu-item-text">博主</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" href="/null" title="项目暂未上线"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="项目暂未上线"/><span class="back-menu-item-text">项目暂未上线</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 文章列表</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 文章分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 全部标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 专栏</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/tags/%E6%9D%82%E8%B0%88"><i class="anzhiyufont anzhiyu-icon-heartbeat faa-tada" style="font-size: 0.9em;"></i><span> 杂谈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/%E5%87%BA%E6%B8%B8%E8%AE%B0%E5%BD%95"><i class="anzhiyufont anzhiyu-icon-thumbs-up faa-tada" style="font-size: 0.9em;"></i><span> 旅行</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill faa-tada" style="font-size: 0.9em;"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/Awebsite/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 优质站点</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/equipment/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 我的装备</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-circle-dot faa-tada" style="font-size: 0.9em;"></i><span> 关于本站</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Java/" style="font-size: 0.88rem;">Java<sup>4</sup></a><a href="/tags/Python/" style="font-size: 0.88rem;">Python<sup>3</sup></a><a href="/tags/%E4%B8%8A%E7%BA%BF/" style="font-size: 0.88rem;">上线<sup>2</sup></a><a href="/tags/%E4%BA%91%E6%97%85%E8%A1%8C/" style="font-size: 0.88rem;">云旅行<sup>4</sup></a><a href="/tags/%E5%87%BA%E6%B8%B8%E8%AE%B0%E5%BD%95/" style="font-size: 0.88rem;">出游记录<sup>1</sup></a><a href="/tags/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/" style="font-size: 0.88rem;">图像处理<sup>1</sup></a><a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 0.88rem;">工具<sup>1</sup></a><a href="/tags/%E6%9D%82%E8%B0%88/" style="font-size: 0.88rem;">杂谈<sup>4</sup></a><a href="/tags/%E6%AF%8F%E6%97%A5%E6%89%93%E5%8D%A1/" style="font-size: 0.88rem;">每日打卡<sup>1</sup></a><a href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" style="font-size: 0.88rem;">深度学习<sup>1</sup></a><a href="/tags/%E7%AE%97%E6%B3%95%E7%A0%94%E7%A9%B6/" style="font-size: 0.88rem;">算法研究<sup>1</sup></a><a href="/tags/%E8%B8%A9%E5%9D%91/" style="font-size: 0.88rem;">踩坑<sup>2</sup></a><a href="/tags/%E9%98%85%E8%AF%BB%E5%88%86%E4%BA%AB/" style="font-size: 0.88rem;">阅读分享<sup>1</sup></a><a href="/tags/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5/" style="font-size: 0.88rem;">项目实践<sup>3</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.music.163.com/m/playlist?id=9552175492&amp;userid=537907294&amp;creatorId=537907294&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("05/08/2024 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2024 By 安知鱼 V1.6.12",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 Abei 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script async="async">(function () {
  var grt = new Date("05/08/2024 00:00:00"); //设置网站上线时间
  var now = new Date();
  var dnum;
  var hnum;
  var mnum;
  var snum;
  var nowHour;

  // 计算并更新天数、小时数、分钟数和秒数
  function updateTime() {
    now = new Date(); // 更新 now 的值
    nowHour = now.getHours(); // 更新 nowHour 的值
    var days = (now - grt) / 1000 / 60 / 60 / 24;
    dnum = Math.floor(days);
    var hours = (now - grt) / 1000 / 60 / 60 - 24 * dnum;
    hnum = Math.floor(hours);
    if (String(hnum).length == 1) {
      hnum = "0" + hnum;
    }
    var minutes = (now - grt) / 1000 / 60 - 24 * 60 * dnum - 60 * hnum;
    mnum = Math.floor(minutes);
    if (String(mnum).length == 1) {
      mnum = "0" + mnum;
    }
    var seconds = (now - grt) / 1000 - 24 * 60 * 60 * dnum - 60 * 60 * hnum - 60 * mnum;
    snum = Math.round(seconds);
    if (String(snum).length == 1) {
      snum = "0" + snum;
    }
  }

  // 更新网页中显示的网站运行时间
  function updateHtml() {
    const footer = document.getElementById("footer");
    if (!footer) return
    let currentTimeHtml = "";
    if (nowHour < 18 && nowHour >= 9) {
      // 如果是上班时间，默认就是"安知鱼-上班摸鱼中.svg"图片，不需要更改
      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    } else {
      // 如果是下班时间，插入"安知鱼-下班啦.svg"图片
      let img = document.querySelector("#workboard .workSituationImg");
      if (img != null) {
        img.src = "";
        img.title = "下班了就该开开心心的玩耍，嘿嘿~";
        img.alt = "下班了就该开开心心的玩耍，嘿嘿~";
      }

      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    }

    if (document.getElementById("runtimeTextTip")) {
      document.getElementById("runtimeTextTip").innerHTML = currentTimeHtml;
    }
  }

  setInterval(() => {
    updateTime();
    updateHtml();
  }, 1000);
})();</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>